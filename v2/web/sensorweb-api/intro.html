<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API Principles | OpenSensorHub Documentation</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/v2/img/logo.png">
    <meta name="description" content="Java-based middleware for building better Sensor Webs and the Internet of Things">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/v2/assets/css/0.styles.e6d66aac.css" as="style"><link rel="preload" href="/v2/assets/js/app.f25264b8.js" as="script"><link rel="preload" href="/v2/assets/js/2.b6409af3.js" as="script"><link rel="preload" href="/v2/assets/js/48.56bf5349.js" as="script"><link rel="prefetch" href="/v2/assets/js/10.52181547.js"><link rel="prefetch" href="/v2/assets/js/11.a92be972.js"><link rel="prefetch" href="/v2/assets/js/12.d385b62a.js"><link rel="prefetch" href="/v2/assets/js/13.5d6e360c.js"><link rel="prefetch" href="/v2/assets/js/14.dc92e924.js"><link rel="prefetch" href="/v2/assets/js/15.bf5f15bd.js"><link rel="prefetch" href="/v2/assets/js/16.3f9d6a35.js"><link rel="prefetch" href="/v2/assets/js/17.a36a7835.js"><link rel="prefetch" href="/v2/assets/js/18.cb43930a.js"><link rel="prefetch" href="/v2/assets/js/19.a0572494.js"><link rel="prefetch" href="/v2/assets/js/20.c0cc6457.js"><link rel="prefetch" href="/v2/assets/js/21.cba0d168.js"><link rel="prefetch" href="/v2/assets/js/22.3f5fd7f7.js"><link rel="prefetch" href="/v2/assets/js/23.e64d3a89.js"><link rel="prefetch" href="/v2/assets/js/24.df8268d7.js"><link rel="prefetch" href="/v2/assets/js/25.9860bcd4.js"><link rel="prefetch" href="/v2/assets/js/26.6ec51060.js"><link rel="prefetch" href="/v2/assets/js/27.dba969e6.js"><link rel="prefetch" href="/v2/assets/js/28.77133da4.js"><link rel="prefetch" href="/v2/assets/js/29.ba00c672.js"><link rel="prefetch" href="/v2/assets/js/3.9ff3ab37.js"><link rel="prefetch" href="/v2/assets/js/30.f96e3501.js"><link rel="prefetch" href="/v2/assets/js/31.c2a50df4.js"><link rel="prefetch" href="/v2/assets/js/32.989d3e2c.js"><link rel="prefetch" href="/v2/assets/js/33.4beec893.js"><link rel="prefetch" href="/v2/assets/js/34.692e5b26.js"><link rel="prefetch" href="/v2/assets/js/35.cdfa0e7e.js"><link rel="prefetch" href="/v2/assets/js/36.bb5f2fd6.js"><link rel="prefetch" href="/v2/assets/js/37.ccacb96f.js"><link rel="prefetch" href="/v2/assets/js/38.d081e840.js"><link rel="prefetch" href="/v2/assets/js/39.79ab9544.js"><link rel="prefetch" href="/v2/assets/js/4.34b1eb31.js"><link rel="prefetch" href="/v2/assets/js/40.a160db8c.js"><link rel="prefetch" href="/v2/assets/js/41.f0c614de.js"><link rel="prefetch" href="/v2/assets/js/42.6707f6c8.js"><link rel="prefetch" href="/v2/assets/js/43.11322be8.js"><link rel="prefetch" href="/v2/assets/js/44.707fddd8.js"><link rel="prefetch" href="/v2/assets/js/45.14c528e5.js"><link rel="prefetch" href="/v2/assets/js/46.1474838c.js"><link rel="prefetch" href="/v2/assets/js/47.56b050df.js"><link rel="prefetch" href="/v2/assets/js/49.5c4ba5a0.js"><link rel="prefetch" href="/v2/assets/js/5.c06f7037.js"><link rel="prefetch" href="/v2/assets/js/50.df8e0617.js"><link rel="prefetch" href="/v2/assets/js/51.e42bca6f.js"><link rel="prefetch" href="/v2/assets/js/6.2e342383.js"><link rel="prefetch" href="/v2/assets/js/7.aea4f403.js"><link rel="prefetch" href="/v2/assets/js/8.98285849.js"><link rel="prefetch" href="/v2/assets/js/9.d23d621d.js">
    <link rel="stylesheet" href="/v2/assets/css/0.styles.e6d66aac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/v2/" class="home-link router-link-active"><img src="/v2/img/logo.png" alt="OpenSensorHub Documentation" class="logo"> <span class="site-name can-hide">OpenSensorHub Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/v2/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/v2/web/" class="nav-link router-link-active">
  Web APIs
</a></div><div class="nav-item"><a href="/v2/dev/" class="nav-link">
  Developers
</a></div><div class="nav-item"><a href="/v2/addons/" class="nav-link">
  Add-Ons
</a></div> <a href="https://github.com/opensensorhub" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/v2/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/v2/web/" class="nav-link router-link-active">
  Web APIs
</a></div><div class="nav-item"><a href="/v2/dev/" class="nav-link">
  Developers
</a></div><div class="nav-item"><a href="/v2/addons/" class="nav-link">
  Add-Ons
</a></div> <a href="https://github.com/opensensorhub" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Sensor Web API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v2/web/sensorweb-api/intro.html" aria-current="page" class="active sidebar-link">API Principles</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/v2/web/sensorweb-api/intro.html#rest-api" class="sidebar-link">REST API</a></li><li class="sidebar-sub-header"><a href="/v2/web/sensorweb-api/intro.html#websocket-binding" class="sidebar-link">Websocket Binding</a></li><li class="sidebar-sub-header"><a href="/v2/web/sensorweb-api/intro.html#mqtt-binding" class="sidebar-link">MQTT Binding</a></li></ul></li><li><a href="/v2/web/sensorweb-api/examples.html" class="sidebar-link">Requests Examples</a></li><li><a href="/v2/web/sensorweb-api/openapi.html" class="sidebar-link">OpenAPI Spec</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>SWE Services</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v2/web/swe-services/sos.html" class="sidebar-link">Sensor Observation Service (SOS)</a></li><li><a href="/v2/web/swe-services/sps.html" class="sidebar-link">Sensor Planning Service (SPS)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>SensorThings API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v2/web/sensorthings-api/intro.html" class="sidebar-link">Introduction</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api-principles"><a href="#api-principles" class="header-anchor">#</a> API Principles</h1> <p>The SensorWeb API allows access to all resources available on an OSH hub, including access to historical data, real-time data feeds and tasking.</p> <p>In addition to the <strong>traditional REST operations</strong>, this API also exposes <strong>Websocket</strong> and <strong>MQTT</strong> endpoints to retrieve <strong>real-time events</strong> corresponding to <strong>resource additions, modifications and deletions</strong>, as well as <strong>push real-time observations</strong> into the system.</p> <h2 id="rest-api"><a href="#rest-api" class="header-anchor">#</a> REST API</h2> <p>This API loosely follows REST principles, by providing read/write access to the following hierarchy of resources:</p> <ul><li><strong>/procedures</strong> <ul><li>/specsheet</li> <li>/history</li> <li>/datastreams</li> <li>/controls
<ul><li>/tasks</li> <li>/status</li></ul></li> <li>/featuresOfInterest</li> <li>/members</li></ul></li> <li><strong>/datastreams</strong> <ul><li>/observations</li></ul></li> <li><strong>/observations</strong></li> <li><strong>/features</strong> <ul><li>/history</li> <li>/members</li></ul></li></ul> <p>REST calls are implemented with the 4 traditional HTTP operations + the PATCH operation for more efficient partial updates:</p> <ul><li><strong>GET</strong> to retrieve individual resources or resource collections</li> <li><strong>POST</strong> to create new resources in a parent collection</li> <li><strong>PUT</strong> and <strong>PATCH</strong> to modify an existing resource</li> <li><strong>DELETE</strong> to delete an existing resource</li></ul> <p><strong>GET</strong> operations support query parameters to further filter the retrieved content. See the <a href="./openapi">OpenAPI specification</a> or the <a href="./examples">request examples</a> for more details.</p> <h2 id="websocket-binding"><a href="#websocket-binding" class="header-anchor">#</a> Websocket Binding</h2> <h3 id="subscription"><a href="#subscription" class="header-anchor">#</a> Subscription</h3> <p>A websocket request can be issued on all ressource collections to get notified of resource changes. The URLs to use are the same as the URLs used for normal <strong>GET</strong> requests, except that they use the <code>ws://</code> or <code>wss://</code> protocol. Most query parameters used to filter collections are also supported.</p> <p>Additional query parameters allow controling the kind of events to subscribe to. These additional parameters are:</p> <ul><li><p><strong>eventTypes</strong>: The type of event(s) to subscribe to. Must be one or more string from the following enum [<code>ADDED, MODIFIED, REMOVED, ENABLED</code>]</p></li> <li><p><strong>eventOnly</strong>: Boolean flag indicating if the resource data should be included in the message or if only a small notification containing the event type, the resource ID and timestamp should be sent to the websocket channel. This flag only applies to <code>ADDED</code> and <code>MODIFIED</code> events.</p></li> <li><p><strong>replaySpeed</strong>: This OSH extension allows replaying historical data at the desired speed. If this value is equal to <code>1.0</code>, the requested data is replayed at the same rate it was produced (corresponding to the phenomenonTime stamps). If greather than <code>1.0</code>, the playback will be accelerated by the corresponding factor. If lower than <code>1.0</code>, the playback will be slowed down by the corresponding factor.</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Although it is simpler to use than the MQTT binding, one restriction of the Websocket API is that it doesn't allow a client to subscribe to multiple collections at a time in the same connection.</p></div> <h3 id="data-push"><a href="#data-push" class="header-anchor">#</a> Data Push</h3> <p>The Websocket incoming channel can also be used to push observations and commands into the system.</p> <p>Observation data can be ingested by opening a channel on a <code>datastream/observations</code> sub-collection. The payload format must be indicated by the <code>resultFormat</code> query parameter.</p> <p>Likewise, commands can be submitted by opening a channel on a <code>controls/tasks</code> sub-collection.</p> <h2 id="mqtt-binding"><a href="#mqtt-binding" class="header-anchor">#</a> MQTT Binding</h2> <p>The MQTT binding works slightly differently as it is available through it's own TCP port, separate from OSH's embedded HTTP server port. The MQTT endpoint is thus always the same and the resource URLs (including any query parameters) are used as MQTT topics instead.</p> <h3 id="subscribe"><a href="#subscribe" class="header-anchor">#</a> Subscribe</h3> <p>An example MQTT SUBSCRIBE request is given below:</p> <table><thead><tr><th><strong>SUBSCRIBE</strong></th> <th style="text-align:left;"></th></tr></thead> <tbody><tr><td>topicName</td> <td style="text-align:left;">&quot;http://demo.opensensorhub.org/api/procedures?eventTypes=ADDED&quot;</td></tr> <tr><td>qos</td> <td style="text-align:left;">1</td></tr></tbody></table> <p>The topic name can include filtering parameters:</p> <table><thead><tr><th><strong>SUBSCRIBE</strong></th> <th style="text-align:left;"></th></tr></thead> <tbody><tr><td>topicName</td> <td style="text-align:left;">&quot;http://demo.opensensorhub.org/api/datastreams/56ef1c2/observations?featureOfInterest=ac2ee56&quot;</td></tr> <tr><td>qos</td> <td style="text-align:left;">1</td></tr></tbody></table> <h3 id="publish"><a href="#publish" class="header-anchor">#</a> Publish</h3> <p>MQTT PUBLISH requests can also be used to post new observation resources. They must target a specific datastream by using its nested <code>observations</code> collection, like so:</p> <table><thead><tr><th><strong>PUBLISH</strong></th> <th style="text-align:left;"></th></tr></thead> <tbody><tr><td>topicName</td> <td style="text-align:left;">&quot;http://demo.opensensorhub.org/api/datastreams/56ef1c2/observations&quot;</td></tr> <tr><td>packetId</td> <td style="text-align:left;">4589</td></tr> <tr><td>qos</td> <td style="text-align:left;">1</td></tr> <tr><td>retainFlag</td> <td style="text-align:left;">true</td></tr> <tr><td>payload</td> <td style="text-align:left;">&quot;{ 'temp': 20.5, 'press': 1032, 'status': 'ok' }&quot;</td></tr></tbody></table> <p>The datastream itself must have been previously created with the HTTP JSON API.</p> <h3 id="mqtt-over-websocket"><a href="#mqtt-over-websocket" class="header-anchor">#</a> MQTT over Websocket</h3> <p>In order to allow the MQTT endpoint to be used by web clients written in Javascript, the SensorWeb API implementation also supports MQTT over websocket.</p> <p>The websocket endpoint to use is a sub-resource of the API root URL, for example:</p> <p><code>wsx://demo.opensensorhub.org/api/mqtt</code></p> <p>The <a href="https://github.com/mqttjs" target="_blank" rel="noopener noreferrer">MQTT.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> library can be used to connect to OSH SensorWeb API endpoint using this protocol.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/opensensorhub/osh-docs/edit/v2/src/web/sensorweb-api/intro.md" target="_blank" rel="noopener noreferrer">Edit</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/18/2020, 9:57:34 AM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/v2/web/sensorweb-api/examples.html">
        Requests Examples
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/v2/assets/js/app.f25264b8.js" defer></script><script src="/v2/assets/js/2.b6409af3.js" defer></script><script src="/v2/assets/js/48.56bf5349.js" defer></script>
  </body>
</html>
